{% extends 'base.html' %}

{% block content %}
<div class="vh-100 d-flex justify-content-center align-items-center" style="background: linear-gradient(45deg, rgba(25,135,84,1) 0%, rgba(255,250,250,1) 100%);">
    <div class="card p-5 rounded-4 shadow w-50">
        <div class="mb-2">
            <a type="button"
                class="btn btn-link link-secondary link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover"
                href="{% url 'index' %}">
                <i class="fa-solid fa-backward-step"></i>
                <span class="fw-light">Regresar al inicio</span>
            </a>
        </div>
        <div class="text-center mb-3">
            <h2>Crear cuenta</h2>
            <h4 class="fw-light text-muted">Registro de empresas</h4>
        </div>
        <form id="registration-form" method="post">
            {% csrf_token %}
            <div id="step-1" class="form-step">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Información general</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.razon_social.id_for_label }}" class="form-label">Razón Social:</label>
                            {{ form.razon_social }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.rfc.id_for_label }}" class="form-label">RFC:</label>
                            {{ form.rfc }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.titular.id_for_label }}" class="form-label">Titular:</label>
                            {{ form.titular }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.cargo.id_for_label }}" class="form-label">Cargo:</label>
                            {{ form.cargo }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.correo.id_for_label }}" class="form-label">Correo Electrónico:</label>
                            {{ form.correo }}
                            <div class="form-text">
                                Incluye un símbolo "@" en tu dirección de correo electrónico.
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.telefono_empresa.id_for_label }}" class="form-label">Teléfono de la
                                Empresa:</label>
                            {{ form.telefono_empresa }}
                        </div>
                    </div>
                </div>
                <div class="d-grid gap-2 mt-3">
                    <button type="button" class="btn btn-pill btn-block btn-success mb-4"
                        id="next-step-1">Siguiente</button>
                </div>
            </div>
            <div id="step-2" class="form-step" style="display: none;">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Información de enlace</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.nombre_enlace.id_for_label }}" class="form-label">Nombre del
                                Enlace:</label>
                            {{ form.nombre_enlace }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.telefono_enlace.id_for_label }}" class="form-label">Teléfono del
                                Enlace:</label>
                            {{ form.telefono_enlace }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.correo_enlace.id_for_label }}" class="form-label">Correo del
                                Enlace:</label>
                            {{ form.correo_enlace }}
                            <div class="form-text">
                                Incluye un símbolo "@" en tu dirección de correo electrónico.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-grid gap-2 mt-3">
                    <button type="button" class="btn btn-pill btn-block btn-success mb-1"
                        id="next-step-2">Siguiente</button>
                    <button type="button" class="btn btn-pill btn-block btn-secondary mb-2"
                        id="prev-step-2">Anterior</button>
                </div>
            </div>
            <div id="step-3" class="form-step" style="display: none;">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Dirección</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.calle.id_for_label }}" class="form-label">Calle:</label>
                            {{ form.calle }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.numero.id_for_label }}" class="form-label">Número:</label>
                            {{ form.numero }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.colonia.id_for_label }}" class="form-label">Colonia:</label>
                            {{ form.colonia }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.ciudad.id_for_label }}" class="form-label">Ciudad:</label>
                            {{ form.ciudad }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.codigo_postal.id_for_label }}" class="form-label">Código
                                Postal:</label>
                            {{ form.codigo_postal }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="{{ form.entidad.id_for_label }}" class="form-label">Entidad:</label>
                            {{ form.entidad }}
                        </div>
                    </div>
                </div>
                <div class="d-grid gap-2 mt-3">
                    <button type="button" class="btn btn-pill btn-block btn-success mb-1"
                        id="next-step-3">Siguiente</button>
                    <button type="button" class="btn btn-pill btn-block btn-secondary mb-2"
                        id="prev-step-3">Anterior</button>
                </div>
            </div>
            <div id="step-4" class="form-step" style="display: none;">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Resumen</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label class="form-label">Usuario:</label>
                            <input class="form-control text-muted" type="text" value="Su razón social" readonly>
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label class="form-label">Contraseña:</label>
                            <input class="form-control text-muted" type="text" value="Su RFC" readonly>
                        </div>
                    </div>
                </div>
                {{ user_form.password1 }}
                {{ user_form.password2 }}
                {{ user_form.username }}
                {{ user_form.es_empresa }}
                <div class="d-grid gap-2 mt-3">
                    <input type="submit" value="Registrarse" class="btn btn-pill text-white btn-block btn-success mb-1">
                    <button type="button" class="btn btn-pill btn-block btn-secondary mb-2"
                        id="prev-step-4">Anterior</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        var currentStep = 1;
        var formSteps = $('.form-step');
        var nextBtns = $('[id^="next-step"]');
        var prevBtns = $('[id^="prev-step"]');
        var submitBtn = $('#submit-btn');

        nextBtns.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var nextFormStep = currentFormStep.next('.form-step');
            var isValid = true;

            currentFormStep.find('input:required, select:required').each(function () {
                if ($(this).val() === '') {
                    isValid = false;
                    $(this).addClass('is-invalid');
                } else {
                    $(this).removeClass('is-invalid');
                }
            });

            if (isValid) {
                currentFormStep.hide();
                nextFormStep.show();
                currentStep++;
            }
        });

        prevBtns.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var prevFormStep = currentFormStep.prev('.form-step');

            currentFormStep.hide();
            prevFormStep.show();
            currentStep--;
        });

        submitBtn.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var isValid = true;

            currentFormStep.find('input:required, select:required').each(function () {
                if ($(this).val() === '') {
                    isValid = false;
                    $(this).addClass('is-invalid');
                } else {
                    $(this).removeClass('is-invalid');
                }
            });

            if (!isValid) {
                return false;
            }
        });
    });
</script>

{% endblock %}