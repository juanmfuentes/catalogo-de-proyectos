{% extends 'base.html' %}

{% block content %}
<div class="p-4">
    <div class="ms-4 mt-4">
        <h1>Editar Alumno</h1>
    </div>
    <div class="p-4 w-100">
        <form id="registration-form" method="post">
            {% csrf_token %}
            <div id="step-1" class="form-step">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Información personal</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.nombre.id_for_label }}" class="form-label">Nombre:</label>
                            {{ form.nombre }}
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.apellido_paterno.id_for_label }}" class="form-label">Apellido
                                Paterno:</label>
                            {{ form.apellido_paterno }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.apellido_materno.id_for_label }}" class="form-label">Apellido
                                Materno:</label>
                            {{ form.apellido_materno }}
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.sexo.id_for_label }}" class="form-label">Sexo:</label>
                            {{ form.sexo }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.correo_personal.id_for_label }}" class="form-label">Correo
                                Personal:</label>
                            {{ form.correo_personal }}
                            <div class="form-text">
                                Incluye un símbolo "@" en tu dirección de correo electrónico.
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.nombre.id_for_label }}" class="form-label">Teléfono:</label>
                            {{ form.telefono }}
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-pill btn-success mb-4"
                        id="next-step-1">Siguiente</button>
                </div>
            </div>
            <div id="step-2" class="form-step" style="display: none;">
                <div class="mb-3">
                    <h4 class="fw-light text-muted">Información escolar</h4>
                </div>
                <div class="row g-3">
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.matricula.id_for_label }}" class="form-label">Matrícula:</label>
                            {{ form.matricula }}
                            <div class="form-text" id="basic-addon4">
                                Este formato sólo admite números.
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.programa_educativo.id_for_label }}" class="form-label">Programa
                                Educativo:</label>
                            {{ form.programa_educativo }}
                        </div>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-md-2">
                        <div class="mb-3">
                            <label for="{{ form.correo_institucional.id_for_label }}" class="form-label">Correo
                                Institucional:</label>
                            {{ form.correo_institucional }}
                            <div class="form-text">
                                Incluye un símbolo "@" en tu dirección de correo electrónico.
                            </div>
                        </div>
                    </div>
                </div>
                {{ user_form.password1 }}
                {{ user_form.password2 }}
                {{ user_form.username }}
                {{ user_form.es_alumno }}
                <div class="mt-3">
                    <input type="submit" value="Actualizar" class="btn btn-pill text-white btn-success mb-1"
                        id="submit-btn">
                    <button type="button" class="btn btn-pill btn-secondary mb-2"
                        id="prev-step-2">Regresar</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        var currentStep = 1;
        var formSteps = $('.form-step');
        var nextBtns = $('[id^="next-step"]');
        var prevBtns = $('[id^="prev-step"]');
        var submitBtn = $('#submit-btn');

        nextBtns.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var nextFormStep = currentFormStep.next('.form-step');
            var isValid = true;

            currentFormStep.find('input:required, select:required').each(function () {
                if ($(this).val() === '') {
                    isValid = false;
                    $(this).addClass('is-invalid');
                } else {
                    $(this).removeClass('is-invalid');
                }
            });

            if (isValid) {
                currentFormStep.hide();
                nextFormStep.show();
                currentStep++;
            }
        });

        prevBtns.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var prevFormStep = currentFormStep.prev('.form-step');

            currentFormStep.hide();
            prevFormStep.show();
            currentStep--;
        });

        submitBtn.on('click', function () {
            var currentFormStep = $(this).closest('.form-step');
            var isValid = true;

            currentFormStep.find('input:required, select:required').each(function () {
                if ($(this).val() === '') {
                    isValid = false;
                    $(this).addClass('is-invalid');
                } else {
                    $(this).removeClass('is-invalid');
                }
            });

            if (!isValid) {
                return false;
            }
        });
    });
</script>


{% endblock %}